#!/usr/bin/env node

/**
 * External dependencies.
 */

var program = require('commander');
var glob = require('glob');

/**
 * Internal dependencies.
 */

var mini = require('..');

program
  .usage('<path-to-tests>')
  .version(require('../package.json', 'utf8').version)
  .option('--formatters', 'display all formatters');

program.name = 'mini';

try {
  require(process.cwd() + '/test/mini.js');
} catch(e) {}

program.parse(process.argv);

var pattern = program.args[0] || 'test/*.test.js';

glob(pattern, { sync: true }, function(err, files) {
  if (err) throw err;
  files.forEach(function(file) {
    require(process.cwd() + '/' + file);
  });
});

mini.run(function(failures) {
  process.exit(failures ? 1 : 0);
});
